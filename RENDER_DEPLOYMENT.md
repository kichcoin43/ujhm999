# Инструкция по деплою на Render.com

## Подготовка к деплою

1. Убедитесь, что у вас есть аккаунт на Render.com
2. Клонируйте репозиторий на локальный компьютер
3. Перейдите в директорию `render-app` и выполните все подготовительные шаги

## Вариант 1: Автоматический деплой (рекомендуется)

1. Перейдите на [dashboard.render.com](https://dashboard.render.com)
2. Выберите "New" → "Web Service"
3. Укажите Github репозиторий или загрузите zip архив проекта
4. В качестве директории выберите `/render-app`
5. Настройте сервис:
   - **Name**: ooobnal-bank
   - **Region**: Frankfurt
   - **Branch**: main
   - **Root Directory**: render-app
   - **Environment**: Node
   - **Build Command**: `chmod +x ./build.sh && ./build.sh`
   - **Start Command**: `cd dist && chmod +x ./start.sh && NODE_ENV=production ./start.sh`

6. Добавьте необходимые переменные окружения:
   - `NODE_VERSION=18.18.0`
   - `NODE_ENV=production`
   - `SESSION_SECRET` (генерируется автоматически)
   - `TELEGRAM_BOT_TOKEN` (добавьте ваш токен)

7. Включите персистентный диск:
   - **Mount Path**: `/opt/render/project/src/data`
   - **Name**: data
   - **Size**: 1 GB

8. Нажмите "Create Web Service"

## Вариант 2: Ручной деплой

Если автоматический деплой не работает, вы можете использовать ручной метод:

1. Выполните скрипт упаковки: `chmod +x ./pack-for-deployment.sh && ./pack-for-deployment.sh`
2. Загрузите полученный архив `render-deploy.zip` на Render.com:
   - Выберите "New" → "Web Service"
   - Выберите "Upload Files"
   - Загрузите архив
   - Настройте сервис как описано в варианте 1

## Проверка работоспособности

После деплоя приложение будет доступно по URL, предоставленному Render.com. Проверьте следующие эндпоинты:

- `/api/health` - должен вернуть статус 200 и JSON с полем `status: "ok"`
- `/api/render-status` - должен показать текущий статус приложения
- `/` - должен открыть главную страницу приложения

## Настройка Telegram бота

После успешного деплоя:

1. Получите URL приложения (например, `https://ooobnal-bank.onrender.com`)
2. Отправьте боту команду `/setWebApp` с указанием этого URL
3. Проверьте работу бота, отправив ему команду `/start`

## Устранение неполадок

Если возникают проблемы при деплое:

1. Проверьте логи сборки и запуска на Render.com
2. Убедитесь, что все переменные окружения корректно настроены
3. Выполните скрипт проверки статуса: `chmod +x ./check-status.sh && ./check-status.sh`
4. Проверьте API эндпоинт `/api/render-status` для диагностики
5. Если проблемы с Telegram ботом, проверьте эндпоинт `/api/telegram-info`

## Дополнительные настройки (опционально)

- **Настройка домена**: В настройках сервиса на Render.com выберите "Custom Domain"
- **Автоматическое обновление**: Включите опцию "Auto-Deploy" в настройках
- **Масштабирование**: Для более высокой нагрузки выберите тарифный план с большими ресурсами

## Контакты для поддержки

Если у вас возникают проблемы с деплоем, обратитесь к разработчикам по электронной почте [support@example.com].